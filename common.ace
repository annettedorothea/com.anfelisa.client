common

target ES6 

ACE {
	init Init {
		on user ( Common.initTexts ) triggers ( Login RouteChanged )
		on noUser ( Common.initTexts ) triggers ( Route RouteChanged )
	}
	RouteChanged {
		on login (  Login.render )
		on registration ( Registration.render )
		on dashboard triggers ( LoadDashboard )
		on profile triggers ( profile.LoadUser )
		on forgotPassword ( ForgotPassword.render )
		on confirmEmail triggers (ConfirmEmail)
		on resetPassword (ResetPassword.render)
		on userList triggers (admin.GetAllUsers) 
		on categories triggers (author.LoadCategories)
	}
	Route {
		on ok ( Common.updateHash )
	}
	CheckUsername preUpdateUI (Registration.displayUsernameSpinner) postUpdateUI (Registration.hideUsernameSpinner) {
		on empty
		on available ( Registration.usernameAvailable )
		on notAvailable ( Registration.usernameNotAvailable )
	}
	RegisterUser preUpdateUI (Common.displaySpinner) postUpdateUI (Common.hideSpinner) {
		on ok (Common.initUser) triggers (Route)
		on error ( Common.displayError ) 
	}
	Login {
		on ok ( Common.initUser ) triggers ( Route )
		on unauthorized ( Common.displayError ) triggers ( Logout )
	}
	LoadDashboard preUpdateUI (Common.displaySpinner) postUpdateUI (Common.hideSpinner) {
		on ok ( Dashboard.render Common.initRole)
		on unauthorized ( Common.displayError ) triggers (Logout)
	}
	Logout {
		on ok ( Common.resetUser ) triggers ( Route )
	}
	ForgotPassword preUpdateUI (Common.displaySpinner) postUpdateUI (Common.hideSpinner) {
		on ok (Common.displayMessage) triggers ( Route )
	}
	ConfirmEmail preUpdateUI (Common.displaySpinner) postUpdateUI (Common.hideSpinner) {
		on ok (Common.displayMessage) triggers (Route)
		on error (Common.displayError) triggers (Route)
	}
	ResetPassword preUpdateUI (Common.displaySpinner) postUpdateUI (Common.hideSpinner) {
		on ok (Common.displayMessage) triggers (Route)
		on error (Common.displayError) triggers (Route)
	}
}

views {
	Common {
		displayError
		displayMessage
		displaySpinner
		hideSpinner
		initTexts
		initUser
		initRole
		resetUser
		updateHash
	}
	Login {
		render
	}
	Registration {
		render
		usernameAvailable
		usernameNotAvailable
		displayUsernameSpinner
		hideUsernameSpinner
	}
	ForgotPassword {
		render
	}
	ResetPassword {
		render
	}
	Dashboard {
		render
	}
}